# Синтетическая генерация данных с использованием PySpark, продолжение проекта из task_1 

Этот проект предназначен для синтетической генерации данных и сохранения их в формате CSV. 
Данные создаются с использованием библиотеки PySpark для обработки больших объемов информации. 
В проекте генерируются случайные значения для различных столбцов с проверкой на допустимое количество NULL значений.

## Основные улучшения в сравнении с проектом synthetic_generation в task_1
- Решает проблему генерации только одного файла. 
- Добавлена возможность создавать файлы за прошедшие дни (учитываются только НЕЧЕТНЫЕ числа)
- Усовершенствован метод переименования файлов и удаления лишних (rename_csv)
- Создание DataFrame, проверка NULL условий, запись данных в файл CSV теперь реализовано ф-циями (create_df, check_null_value, data_in_csv)
- Путь к директории для сохранения файла теперь задается, испульзуя библиотеку argparse

## Описание проекта

Проект включает в себя следующие возможности:

- Генерация данных для полей: `id`, `name`, `email`, `city`, `age`, `salary`, `registration_date`.
- Контроль и подсчет значений NULL в каждом столбце (не более 5%).
- Сохранение данных в CSV файлы с именем в формате `год-месяц-день-dev.csv`.
- Генерация данных и их обработка с использованием PySpark.

## Структура данных

- **id**: Уникальный идентификатор строки.
- **name**: Случайное имя из списка, состоящее минимум из 5 символов.
- **email**: Электронная почта, сгенерированная на основе имени, года рождения и домена (`ru` или `com`).
- **city**: Случайный город из списка, длина названия не менее 7 символов.
- **age**: Возраст в диапазоне от 18 до 95 лет.
- **salary**: Случайное значение зарплаты с шагом в 1000.
- **registration_date**: Дата регистрации, которая не может быть меньше 5 лет после даты рождения.

## Особенности генерации данных

1. **Генерация имени**: Имя выбирается случайно из списка русских имен, где минимум 5 символов.
2. **Генерация города**: Город выбирается случайно из списка, где минимум 7 символов.
3. **Генерация возраста**: Возраст генерируется случайно от 18 до 95 лет.
4. **Генерация зарплаты**: Зарплата генерируется случайно и умножается на 1000.
5. **Генерация даты регистрации**: Дата регистрации генерируется так, чтобы она не была раньше, чем возраст + 5 лет.

## Проверка на NULL значения

Проект содержит проверку на количество NULL значений в каждом столбце данных. Проверяется, что количество NULL не превышает 5%. Если это происходит, выводится предупреждающее сообщение. Для тестирования функция проверки может быть закомментирована.

## Функция переименования файлов CSV

После генерации данные сохраняются в файл, который переименовывается в формате `год-месяц-день-dev.csv`. Все промежуточные файлы удаляются, оставляя только конечный результат.

## Использование

### Требования:
- Python
- PySpark
- Модули: `random`, `datetime`, `os`, `argparse`, `transliterate`

### Команды для запуска

1. Для генерации данных:

```bash
python main.py --rows 100 --days 5 --dir /path/to/output
```
--rows: Количество строк для генерации (по умолчанию 100).
--days: Количество дней, за которые нужно сгенерировать данные (по умолчанию 5).
--dir: Директория для сохранения CSV файлов (по умолчанию /path/to/output)